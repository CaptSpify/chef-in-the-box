# Package generated configuration file
# See the sshd_config(5) manpage for details
# This config is supplied by Chef

# What ports, IPs and protocols we listen for
<% unless node['sshd']['Port'].nil? -%>
  <% node['sshd']['Port'].each do |port| -%>
Port <%= port %>
  <% end -%>
<% else -%>
Port <%= @Port %>
<% end -%>

# Use these options to restrict which interfaces/protocols sshd will bind to
ListenAddress <%= node['sshd']['ListenAddress'] %>
Protocol <%= node['sshd']['Protocol'] %>
#Privilege Separation is turned on for security
UsePrivilegeSeparation <%= node['sshd']['UserPrivilegeSeparation'] %>

# Logging
SyslogFacility <%= node['sshd']['SyslogFacility'] %>
LogLevel <%= node['sshd']['LogLevel'] %>

# Authentication:
LoginGraceTime <%= node['sshd']['LoginGraceTime'] %>
PermitRootLogin <%= node['sshd']['PermitRootLogin'] %>
StrictModes <%= node['sshd']['StrictModes'] %>

RSAAuthentication <%= node['sshd']['RSAAuthentication'] %>
PubkeyAuthentication <%= node['sshd']['PubkeyAuthentication'] %>
AuthorizedKeysFile <%= node['sshd']['AuthorizedKeysFile'] %>

# Don't read the user's ~/.rhosts and ~/.shosts files
IgnoreRhosts <%= node['sshd']['IgnoreRhosts'] %>

# Allow Agent Forwarding
AllowAgentForwarding <%= node['sshd']['AllowAgentForwarding'] %>

# For this to work you will also need host keys in /etc/ssh_known_hosts
RhostsRSAAuthentication <%= node['sshd']['RhostsRSAAuthentication'] %>
# similar for protocol version 2
HostbasedAuthentication <%= node['sshd']['HostbasedAuthentication'] %>

# To enable empty passwords, change to yes (NOT RECOMMENDED)
PermitEmptyPasswords <%= node['sshd']['PermitEmptyPasswords'] %>

# Change to yes to enable challenge-response passwords (beware issues with
# some PAM modules and threads)
ChallengeResponseAuthentication <%= node['sshd']['ChallengeResponseAuthentication'] %>

X11Forwarding <%= node['sshd']['X11Forwarding'] %>
X11DisplayOffset <%= node['sshd']['X11DisplayOffset'] %>
PrintMotd <%= node['sshd']['PrintMotd'] %>
PrintLastLog <%= node['sshd']['PrintLastLog'] %>
TCPKeepAlive <%= node['sshd']['TCPKeepAlive'] %>

# Allow client to pass locale environment variables
AcceptEnv <%= node['sshd']['AcceptEnv'] %>

Subsystem <%= node['sshd']['Subsystem'] %>

# Set this to 'yes' to enable PAM authentication, account processing,
# and session processing. If this is enabled, PAM authentication will
# be allowed through the ChallengeResponseAuthentication and
# PasswordAuthentication.  Depending on your PAM configuration,
# PAM authentication via ChallengeResponseAuthentication may bypass
# the setting of "PermitRootLogin without-password".
# If you just want the PAM account and session checks to run without
# PAM authentication, then enable this but set PasswordAuthentication
# and ChallengeResponseAuthentication to 'no'.
UsePAM <%= node['sshd']['UsePAM'] %>
